const a23_0x5d66b6=a23_0x4f5e;function a23_0x384d(){const _0x2db4ef=['Fetching\x20API:\x20','6477611fpMBnh','Error\x20in\x20fetchMediaData:','key','API\x20response:','length','4671qMisag','conversation','creator','match','audio','❌\x20Une\x20erreur\x20est\x20survenue.','>\x20⚠️\x20contenu\x20introuvable,\x20veuillez\x20essayer\x20de\x20nouveau\x20plutard\x20','annuler','Invalid\x20media\x20data:','result','signal','ptt','downloadUrl','9582vXZHxA','videos','❌\x20Annuler','from','mp3','log','off','messages','url','mp4','212611EDxBEn','audio/mpeg','\x0aChoisissez\x20une\x20vidéo:','https://apis.davidcyriltech.my.id/youtube','video/mp4','toLowerCase','messages.upsert','3223916EwHvmV','json','thumbnail','message','25GQgocF','trim','\x20caractères).','cancel','1240CfwgMi','Error\x20in\x20sendYtMusic:','video','status','buttonsResponseMessage','8YakzEV','?url=','API\x20request\x20failed\x20with\x20status\x20','push','🎵\x20Résultats\x20pour:\x20','21834850DtLEZo','7136919iuNJLO','title','...','sendMessage','YouTube\x20Downloader','success','remoteJid','Error\x20fetching\x20thumbnail:','error','substring','selectedButtonId','stringify'];a23_0x384d=function(){return _0x2db4ef;};return a23_0x384d();}(function(_0x4f6c07,_0x41a1f1){const _0x5772a6=a23_0x4f5e,_0x1e3d97=_0x4f6c07();while(!![]){try{const _0x145d73=parseInt(_0x5772a6(0xcf))/0x1+-parseInt(_0x5772a6(0xde))/0x2*(parseInt(_0x5772a6(0xfb))/0x3)+-parseInt(_0x5772a6(0xd6))/0x4+parseInt(_0x5772a6(0xda))/0x5*(parseInt(_0x5772a6(0xc5))/0x6)+parseInt(_0x5772a6(0xf6))/0x7*(-parseInt(_0x5772a6(0xe3))/0x8)+parseInt(_0x5772a6(0xe9))/0x9+parseInt(_0x5772a6(0xe8))/0xa;if(_0x145d73===_0x41a1f1)break;else _0x1e3d97['push'](_0x1e3d97['shift']());}catch(_0x1b20a5){_0x1e3d97['push'](_0x1e3d97['shift']());}}}(a23_0x384d,0x7a29c));import a23_0x3e1743 from'yt-search';import a23_0x2be7ea from'node-fetch';import{send_reaction_message,send_text_message}from'../utils/sendmessagewa.js';const API_BASE_URL=a23_0x5d66b6(0xd2),DEFAULT_TIMEOUT=0xea60,MAX_TITLE_LENGTH=0x32,MAX_RESULTS=0x5;export async function sendYtMusic(_0x3c7edc,_0x49ae05,_0x549648,_0x4cd315){const _0x34ecc4=a23_0x5d66b6,{key:_0x49be8e}=_0x49ae05,_0x531243=_0x49be8e['remoteJid'];try{if(!_0x549648[_0x34ecc4(0xfa)])return await send_text_message(_0x3c7edc,_0x49ae05,'❌\x20Veuillez\x20fournir\x20un\x20titre\x20de\x20vidéo.',_0x531243);const _0x42aa7f=_0x549648['join']('\x20')[_0x34ecc4(0xdb)]();if(_0x42aa7f[_0x34ecc4(0xfa)]>MAX_TITLE_LENGTH)return await send_text_message(_0x3c7edc,_0x49ae05,'❌\x20Titre\x20trop\x20long\x20(max\x20'+MAX_TITLE_LENGTH+_0x34ecc4(0xdc),_0x531243);await send_reaction_message(_0x3c7edc,_0x49ae05,_0x531243,'🔍');const _0x124f23=await a23_0x3e1743(_0x42aa7f),_0x18b8c1=_0x124f23[_0x34ecc4(0xc6)]['slice'](0x0,MAX_RESULTS);if(!_0x18b8c1[_0x34ecc4(0xfa)])return await send_text_message(_0x3c7edc,_0x49ae05,'❌\x20Aucune\x20vidéo\x20trouvée.',_0x531243);const _0x2b5b22=_0x18b8c1['map']((_0x619d37,_0x427cb5)=>({'buttonId':'song_'+_0x427cb5,'buttonText':{'displayText':_0x427cb5+0x1+'.\x20'+formatTitle(_0x619d37[_0x34ecc4(0xea)],0x14)},'type':0x1}));_0x2b5b22[_0x34ecc4(0xe6)]({'buttonId':_0x34ecc4(0xdd),'buttonText':{'displayText':_0x34ecc4(0xc7)},'type':0x1}),await _0x3c7edc[_0x34ecc4(0xec)](_0x531243,{'text':_0x34ecc4(0xe7)+_0x42aa7f+_0x34ecc4(0xd1),'footer':_0x34ecc4(0xed),'buttons':_0x2b5b22,'headerType':0x1});const _0x4bfcf7=await waitForUserChoice(_0x3c7edc,_0x531243,_0x18b8c1);if(!_0x4bfcf7)return await send_text_message(_0x3c7edc,_0x49ae05,'>\x20❌\x20Annulation\x20de\x20la\x20recherche\x20ou\x20temps\x20d\x27attente\x20expiré.',_0x531243);await send_reaction_message(_0x3c7edc,_0x49ae05,_0x531243,'📥');const _0xe58af9=_0x4cd315==='video'?_0x34ecc4(0xce):_0x34ecc4(0xc9),_0x4e611c=API_BASE_URL+'/'+_0xe58af9+_0x34ecc4(0xe4)+_0x4bfcf7[_0x34ecc4(0xcd)],_0x205e90=await fetchMediaData(_0x4e611c,_0x4cd315);if(!_0x205e90?.[_0x34ecc4(0xc1)]?.[_0x34ecc4(0xcd)])return console['error'](_0x34ecc4(0xc0),_0x205e90),await send_text_message(_0x3c7edc,_0x49ae05,_0x34ecc4(0x101),_0x531243);const _0x2a23f3=_0x205e90['result'][_0x34ecc4(0xd8)]||_0x205e90[_0x34ecc4(0xc1)]['image'],_0x5a6683=await fetchThumbnail(_0x2a23f3);await sendMediaMessage(_0x3c7edc,_0x531243,{'type':_0x4cd315,'mediaUrl':_0x205e90[_0x34ecc4(0xc1)][_0x34ecc4(0xcd)],'title':_0x205e90[_0x34ecc4(0xc1)]['title'],'thumbnail':_0x5a6683,'videoUrl':_0x4bfcf7['url']});}catch(_0x7c49f5){console[_0x34ecc4(0xf1)](_0x34ecc4(0xdf),_0x7c49f5),await handleError(_0x3c7edc,_0x49ae05,_0x531243);}}async function fetchMediaData(_0x5363e0,_0x4ca8b7){const _0x22387b=a23_0x5d66b6,_0x3dab45=new AbortController(),_0x2b671b=setTimeout(()=>_0x3dab45['abort'](),0x186a0);try{console['log'](_0x22387b(0xf5)+_0x5363e0);const _0x1e2a0d=await a23_0x2be7ea(_0x5363e0,{'signal':_0x3dab45[_0x22387b(0xc2)]});if(!_0x1e2a0d['ok'])throw new Error(_0x22387b(0xe5)+_0x1e2a0d[_0x22387b(0xe1)]);const _0x1be832=await _0x1e2a0d[_0x22387b(0xd7)]();console[_0x22387b(0xca)](_0x22387b(0xf9),JSON[_0x22387b(0xf4)](_0x1be832,null,0x2));if(_0x4ca8b7===_0x22387b(0xff)){if(!(_0x1be832[_0x22387b(0xe1)]===0xc8&&_0x1be832[_0x22387b(0xee)]&&_0x1be832[_0x22387b(0xc1)]?.[_0x22387b(0xc4)]))throw new Error('Invalid\x20audio\x20response\x20format');return{'creator':_0x1be832[_0x22387b(0xfd)],'status':_0x1be832[_0x22387b(0xe1)],'result':{'id':_0x1be832[_0x22387b(0xc1)]['id'],'title':_0x1be832[_0x22387b(0xc1)][_0x22387b(0xea)],'image':_0x1be832[_0x22387b(0xc1)]['image'],'url':_0x1be832[_0x22387b(0xc1)][_0x22387b(0xc4)]}};}else{if(!(_0x1be832[_0x22387b(0xe1)]===!![]&&_0x1be832[_0x22387b(0xc1)]?.[_0x22387b(0xcd)]))throw new Error('Invalid\x20video\x20response\x20format');return{'creator':_0x1be832['creator'],'status':_0x1be832[_0x22387b(0xe1)],'result':{'title':_0x1be832['result'][_0x22387b(0xea)],'thumbnail':_0x1be832['result'][_0x22387b(0xd8)],'url':_0x1be832[_0x22387b(0xc1)][_0x22387b(0xcd)]}};}}catch(_0x77735c){return console['error'](_0x22387b(0xf7),{'url':_0x5363e0,'error':_0x77735c[_0x22387b(0xd9)],'stack':_0x77735c['stack']}),null;}finally{clearTimeout(_0x2b671b);}}async function sendMediaMessage(_0x323a7c,_0x19321a,{type:_0x3759ea,mediaUrl:_0x367625,title:_0x245330,thumbnail:_0x391394,videoUrl:_0x21519c}){const _0x50c2d2=a23_0x5d66b6,_0x50b01c={[_0x3759ea]:{'url':_0x367625},'mimetype':_0x3759ea===_0x50c2d2(0xe0)?_0x50c2d2(0xd3):_0x50c2d2(0xd0),'caption':_0x245330,'contextInfo':{'externalAdReply':{'title':formatTitle(_0x245330,0x3c),'body':'Téléchargé\x20via\x20YouTube','thumbnail':_0x391394,'mediaType':_0x3759ea===_0x50c2d2(0xe0)?0x2:0x1,'mediaUrl':_0x21519c,'sourceUrl':_0x21519c}}};_0x3759ea==='audio'&&(_0x50b01c[_0x50c2d2(0xc3)]=![]),await _0x323a7c[_0x50c2d2(0xec)](_0x19321a,_0x50b01c);}function formatTitle(_0x2e4cc7,_0x18100f){const _0x1f5ad1=a23_0x5d66b6;return _0x2e4cc7[_0x1f5ad1(0xfa)]>_0x18100f?_0x2e4cc7[_0x1f5ad1(0xf2)](0x0,_0x18100f-0x3)+_0x1f5ad1(0xeb):_0x2e4cc7;}async function fetchThumbnail(_0x4f7bbd){const _0x2d4318=a23_0x5d66b6;try{const _0x4616b0=await a23_0x2be7ea(_0x4f7bbd);return Buffer[_0x2d4318(0xc8)](await _0x4616b0['arrayBuffer']());}catch(_0x20a811){return console[_0x2d4318(0xf1)](_0x2d4318(0xf0),_0x20a811),null;}}function a23_0x4f5e(_0x4b88d1,_0x2a1d58){const _0x384d83=a23_0x384d();return a23_0x4f5e=function(_0x4f5e63,_0x46886){_0x4f5e63=_0x4f5e63-0xc0;let _0xb2756f=_0x384d83[_0x4f5e63];return _0xb2756f;},a23_0x4f5e(_0x4b88d1,_0x2a1d58);}async function handleError(_0x11788f,_0x5e1e62,_0x2e813a){const _0x30fb1d=a23_0x5d66b6;await send_text_message(_0x11788f,_0x5e1e62,_0x30fb1d(0x100),_0x2e813a),await send_reaction_message(_0x11788f,_0x5e1e62,_0x2e813a,'❌');}async function waitForUserChoice(_0xd47186,_0x13ef28,_0x2db5b9){return new Promise(_0x299aaf=>{const _0x5becfa=a23_0x4f5e,_0x1053f6=async _0x229beb=>{const _0x1fbe78=a23_0x4f5e;for(const _0x14ad4f of _0x229beb[_0x1fbe78(0xcc)]){if(_0x14ad4f[_0x1fbe78(0xf8)][_0x1fbe78(0xef)]===_0x13ef28){const _0xc0b7dc=getChoiceFromMessage(_0x14ad4f);if(_0xc0b7dc===_0x1fbe78(0xdd)){_0x262d07(),_0x299aaf(null);return;}if(_0xc0b7dc>=0x0&&_0xc0b7dc<_0x2db5b9[_0x1fbe78(0xfa)]){_0x262d07(),_0x299aaf(_0x2db5b9[_0xc0b7dc]);return;}}}},_0x262d07=()=>{const _0x3d59d4=a23_0x4f5e;_0xd47186['ev'][_0x3d59d4(0xcb)](_0x3d59d4(0xd5),_0x1053f6),clearTimeout(_0xdf8c06);},_0xdf8c06=setTimeout(()=>{_0x262d07(),_0x299aaf(null);},DEFAULT_TIMEOUT);_0xd47186['ev']['on'](_0x5becfa(0xd5),_0x1053f6);});}function getChoiceFromMessage(_0x477a68){const _0x486a97=a23_0x5d66b6;if(_0x477a68[_0x486a97(0xd9)]?.[_0x486a97(0xe2)]){const _0x3ffbaf=_0x477a68[_0x486a97(0xd9)]['buttonsResponseMessage'][_0x486a97(0xf3)];if(_0x3ffbaf===_0x486a97(0xdd))return'cancel';const _0x50ce84=_0x3ffbaf[_0x486a97(0xfe)](/song_(\d+)/);return _0x50ce84?parseInt(_0x50ce84[0x1]):-0x1;}if(_0x477a68[_0x486a97(0xd9)]?.[_0x486a97(0xfc)]){const _0x1017d5=_0x477a68[_0x486a97(0xd9)][_0x486a97(0xfc)][_0x486a97(0xd4)]();if(_0x1017d5===_0x486a97(0x102)||_0x1017d5==='cancel')return'cancel';const _0x4b3d53=parseInt(_0x1017d5);return isNaN(_0x4b3d53)?-0x1:_0x4b3d53-0x1;}return-0x1;}